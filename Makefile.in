##############################################################################
##
##    Makefile.in                     NQ                         Werner Nickel
##

##
##    Values imported from the configure script
##
top_srcdir = @top_srcdir@
top_builddir = @top_builddir@
srcdir = @srcdir@
VPATH = @srcdir@
subdir = .

GAPROOT=@GAPROOT@
BINDIR=bin/@GAPARCH@

all: compile

gap: compile doc

compile:
	(cd src; make)
	mkdir -p $(BINDIR)
	mv src/nq $(BINDIR)

doc:
	gap -A makedoc.g

test:
	(cd examples; make)

clean:
	(cd src;      make clean)
	(cd examples; make clean)
	(cd doc && rm -f *.aux *.bbl *.blg *.brf *.idx *.ilg *.ind *.log *.out *.pnr *.tex *.toc)
	(cd doc && rm -f *~ nqbib.xml.bib)
	(cd doc && rm -f test/nqman.tst test/diffs)

distclean: clean
	(cd src;      make distclean)
	(cd examples; make distclean)
	rm -f Makefile src/Makefile examples/Makefile
	rm -rf bin
	rm -rf .\#*
	rm -f *~ */*~
	rm -rf nq-2.? nq-2_?.tar nq-2_?.tar.gz
	rm -f config.cache config.log config.status


.PRECIOUS: Makefile
Makefile: $(srcdir)/Makefile.in $(top_builddir)/config.status
	cd $(top_builddir) && $(SHELL) ./config.status $@

$(top_builddir)/config.status: $(top_srcdir)/configure $(CONFIG_STATUS_DEPENDENCIES)
	$(SHELL) ./config.status --recheck

$(top_srcdir)/configure: $(top_srcdir)/configure.ac $(top_srcdir)/VERSION
	cd $(top_srcdir) && autoreconf

.PHONY: all gap compile doc test clean distclean
